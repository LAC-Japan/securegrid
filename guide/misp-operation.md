---
title: MISP運用ガイド
---

[TOP](/securegrid/)

# 概要

MISPを運用する上で参考となる情報を記載します。

ご不明点につきましては、
[こちらのお問い合わせフォーム](https://krs.bz/lac/m/securegrid?_ga=2.137599600.1173151998.1640651755-16565361.1638256099&_fsi=8H1ssyw9){:target="_blank"}
よりSecureGRIDアライアンス事務局にお気軽にご連絡ください。

# MISPバージョンアップ手順

MISPは活発に開発が行われており、頻繁にバージョンアップが公開されます。
バージョンアップでは新機能の追加・不具合の修正等が行われるため、積極的な最新版への更新を推奨します。

また、一定以上古いバージョンと最新版のプログラムの間では互換性がなくなることもあり、SecureGRID Portalでは最新版のMISPをサポート対象といたします。SecureGRIDアライアンス事務局よりMISPバージョンアップ時にはお知らせもいたしますので、以下手順を参考にご対応いただければ幸いです。


## バックアップ

万が一アップデート操作でトラブルが起きた場合に備えて、事前のバックアップを推奨いたします。

* AWS環境等サーバ全体のバックアップが可能な場合、作業前にサーバ環境のバックアップを取得する
* サーバ全体のバックアップが難しい環境の場合、MISPをインストールしたサーバにログインし以下操作を実施
	* プログラムのバックアップ：　`sudo cp -pr /var/www/MISP /var/www/MISP_bkYYYYmmdd`
	* データベースのバックアップ：　`sudo mysqldump -u misp -p misp > hoge.sql`
	hoge.sqlは任意のファイル名にしてください。またコマンド実行後はmispユーザのパスワードを求められます。


## MISPのアップデート

* MISPにWebアクセスし、管理者権限のあるユーザでログイン
* 「Administration」 ⇒ 「Server Settings & Maintenance」 を押下
* 「Diagnostics」を押下
* 「Update MISP」を押下
* イベント表示など各画面が想定通り動作することを確認


## アップデートで問題が起きた場合の対応

アップデート対応後画面操作でエラーが発生して使えなくなったなど、何らかの問題が発生することがあります。  
その場合、原因調査・対応を行い解決できればベストですが、解決できない場合は取り急ぎ下記の手順にてバージョンアップの切り戻しを行ってください。  
そのうえでサポートが必要な場合、SecureGRIDアライアンス事務局までご相談ください。

* AWS等サーバ全体のバックアップが取得できている場合、そのバージョンにきり戻す
* サーバ全体のバックアップが取得できておらず、プログラム・データベースを手動でバックアップしている場合、以下手順で切り戻す
	* MISPインストールサーバにログイン
	* プログラムフォルダ復元：　`sudo cp -pr /var/www/MISP_bkYYYYmmdd /var/www/MISP`
	* データベース復元：　`sudo mysql -u misp -p misp < hoge.sql`
	hoge.sqlはバックアップ先のファイル名にしてください。またバックアップ時と同様、コマンド実行後はmispユーザのパスワードを求められます。
	* サービス再起動： `sudo systemctl restart apache2`
* MISPにWebアクセスし、正常に動作することを確認
